@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Typography */
    --font-body: "Averia Serif Libre", ui-serif, serif;
    --font-heading: "Averia Serif Libre", ui-serif, serif;
    --font-code: "IBM Plex Mono", ui-monospace, monospace;
    --font-sans: var(--font-body);
    --font-serif: var(--font-heading);
    --font-mono: var(--font-code);
    --line-height-body: 1.65;
    --line-height-heading: 1.15;
    --tracking-tight: -0.025em;

    /* Radii */
    --radius-sm: 0.75rem;
    --radius-md: 1rem;
    --radius-lg: 1.5rem;
    --radius: var(--radius-md);

    /* Shadows */
    --shadow-xs: 0 8px 18px -14px rgba(28, 23, 72, 0.32);
    --shadow-sm: 0 18px 46px -28px rgba(86, 72, 198, 0.35);
    --shadow-md: 0 32px 84px -40px rgba(78, 51, 182, 0.38);
    --shadow-lg: 0 46px 120px -42px rgba(41, 30, 110, 0.45);

    /* Light theme surfaces */
    --color-surface: oklch(0.99 0.003 280);
    --color-surface-muted: oklch(0.965 0.01 283);
    --color-surface-elevated: oklch(0.98 0.016 288);
    --color-overlay: rgba(255, 255, 255, 0.86);

    /* Light theme text + borders */
    --color-text-strong: oklch(0.17 0.004 272);
    --color-text-soft: oklch(0.45 0.01 275);
    --color-border-subtle: oklch(0.92 0.009 284);
    --color-border-soft: oklch(0.9 0.012 287);
    --color-border-strong: oklch(0.72 0.042 285);
    --color-divider: color-mix(in oklch, var(--color-border-soft) 78%, transparent);

    /* Brand palette */
    --primary: oklch(0.563 0.2712 294.6734);
    --primary-foreground: oklch(1 0 0);
    --secondary: oklch(0.952 0.007 268.5467);
    --secondary-foreground: oklch(0.1344 0 0);
    --accent: oklch(0.9334 0.0318 274.1247);
    --accent-foreground: oklch(0.34 0.091 264);
    --muted-foreground: var(--color-text-soft);
    --destructive: oklch(0.6446 0.1769 28.625);
    --destructive-foreground: oklch(1 0 0);

    /* Semantic tokens consumed by tailwind config */
    --background: var(--color-surface);
    --foreground: var(--color-text-strong);
    --card: var(--color-overlay);
    --card-foreground: var(--color-text-strong);
    --popover: var(--color-overlay);
    --popover-foreground: var(--color-text-strong);
    --muted: var(--color-surface-muted);
    --accent: var(--accent);
    --destructive: var(--destructive);
    --border: var(--color-border-soft);
    --input: var(--color-border-soft);
    --ring: var(--primary);

    /* Charts + sidebar legacy tokens */
    --chart-1: oklch(0.7493 0.1353 162.5062);
    --chart-2: var(--primary);
    --chart-3: oklch(0.7724 0.1638 62.5972);
    --chart-4: oklch(0.5406 0.2057 265.0633);
    --chart-5: oklch(0.559 0 0);
    --sidebar: color-mix(in oklch, var(--color-surface) 92%, white 8%);
    --sidebar-foreground: var(--color-text-strong);
    --sidebar-primary: var(--primary);
    --sidebar-primary-foreground: var(--primary-foreground);
    --sidebar-accent: var(--color-surface-muted);
    --sidebar-accent-foreground: var(--color-text-strong);
    --sidebar-border: var(--color-border-subtle);
    --sidebar-ring: var(--primary);
  }

  .dark {
    --color-surface: oklch(0.24 0.01 275);
    --color-surface-muted: oklch(0.28 0.012 279);
    --color-surface-elevated: oklch(0.3 0.015 283);
    --color-overlay: rgba(19, 21, 40, 0.92);

    --color-text-strong: oklch(0.94 0.004 282);
    --color-text-soft: oklch(0.72 0.01 281);
    --color-border-subtle: oklch(0.32 0.01 280);
    --color-border-soft: oklch(0.36 0.012 282);
    --color-border-strong: oklch(0.53 0.022 284);
    --color-divider: color-mix(in oklch, var(--color-border-strong) 70%, transparent);

    --background: var(--color-surface);
    --foreground: var(--color-text-strong);
    --card: color-mix(in oklch, var(--color-overlay) 82%, black 18%);
    --card-foreground: var(--color-text-strong);
    --popover: color-mix(in oklch, var(--color-overlay) 88%, black 12%);
    --popover-foreground: var(--color-text-strong);
    --muted: var(--color-surface-muted);
    --muted-foreground: var(--color-text-soft);
    --accent: oklch(0.2715 0.0409 267.7025);
    --accent-foreground: oklch(0.82 0.12 258);
    --destructive: oklch(0.7337 0.1484 29.0756);
    --destructive-foreground: oklch(1 0 0);
    --border: var(--color-border-soft);
    --input: var(--color-border-soft);
    --ring: var(--primary);

    --sidebar: oklch(0.21 0.006 301.035);
    --sidebar-foreground: var(--color-text-strong);
    --sidebar-primary: var(--primary);
    --sidebar-primary-foreground: var(--primary-foreground);
    --sidebar-accent: oklch(0.2914 0.0146 279.8154);
    --sidebar-accent-foreground: oklch(0.84 0.16 292);
    --sidebar-border: var(--color-border-strong);
    --sidebar-ring: var(--primary);
  }

  html {
    scroll-behavior: smooth;
    text-rendering: optimizeLegibility;
  }

  * {
    border-color: var(--border);
  }

  body {
    background-color: var(--background);
    color: var(--foreground);
    font-family: var(--font-body);
    letter-spacing: var(--tracking-tight);
    line-height: var(--line-height-body);
  }

  svg {
    display: inline-block;
    vertical-align: middle;
  }

  .app-shell {
    min-height: 100vh;
    background-color: transparent;
    overflow-x: clip;
  }

  .app-shell::before,
  .app-shell::after {
    content: "";
    position: absolute;
    inset: 0;
    z-index: -2;
    pointer-events: none;
    transition: opacity 0.5s ease, transform 1.2s ease;
  }

  .app-shell::before {
    background-color: #fefcff;
    background-image: radial-gradient(
        circle at 30% 70%,
        rgba(173, 216, 230, 0.35),
        transparent 60%
      ),
      radial-gradient(
        circle at 70% 30%,
        rgba(255, 182, 193, 0.4),
        transparent 60%
      );
    transform: scale(1);
    opacity: 1;
  }

  .app-shell::after {
    background-image: radial-gradient(
        circle at 20% 20%,
        rgba(105, 96, 255, 0.42),
        transparent 55%
      ),
      radial-gradient(
        circle at 75% 30%,
        rgba(194, 71, 255, 0.35),
        transparent 62%
      ),
      radial-gradient(
        circle at 50% 80%,
        rgba(25, 175, 208, 0.25),
        transparent 68%
      ),
      linear-gradient(160deg, #050112 0%, #0a1028 45%, #010108 100%);
    opacity: 0;
    transform: scale(1.02);
  }

  .dark .app-shell::before {
    opacity: 0;
    transform: scale(1.05);
  }

  .dark .app-shell::after {
    opacity: 1;
    transform: scale(1);
  }

  main section {
    position: relative;
  }

  :focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: 3px;
  }

  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }
}

@layer utilities {
  @keyframes fade-in {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .bg-aura-light {
    background-color: #fefcff;
    background-image: radial-gradient(
        circle at 30% 70%,
        rgba(173, 216, 230, 0.35),
        transparent 60%
      ),
      radial-gradient(
        circle at 70% 30%,
        rgba(255, 182, 193, 0.4),
        transparent 60%
      );
  }

  .bg-aura-dark {
    background-image: radial-gradient(
        circle at 15% 20%,
        rgba(110, 114, 255, 0.35),
        transparent 60%
      ),
      radial-gradient(
        circle at 85% 25%,
        rgba(232, 74, 248, 0.32),
        transparent 62%
      ),
      radial-gradient(
        circle at 50% 80%,
        rgba(14, 116, 212, 0.25),
        transparent 68%
      ),
      linear-gradient(160deg, #040312 0%, #0a0f2a 45%, #01000f 100%);
  }

  .section-divider {
    position: relative;
  }

  .section-divider::after {
    content: "";
    position: absolute;
    inset-block-end: 0;
    height: 1px;
    background-color: rgba(18, 21, 36, 0.14);
  }

  .section-divider--short::after {
    inset-inline: clamp(24px, 10vw, 180px);
  }

  .section-divider--full::after {
    inset-inline: 0;
  }

  .dark .section-divider::after {
    background-color: rgba(230, 232, 250, 0.22);
  }

  .animate-fade-in {
    animation: fade-in 0.6s ease-out forwards;
    animation-delay: var(--animation-delay, 0ms);
    opacity: 0;
  }

  .delay-0ms {
    --animation-delay: 0ms;
  }

  .delay-100ms {
    --animation-delay: 100ms;
  }

  .delay-200ms {
    --animation-delay: 200ms;
  }

  .delay-300ms {
    --animation-delay: 300ms;
  }

  .delay-400ms {
    --animation-delay: 400ms;
  }

  .delay-500ms {
    --animation-delay: 500ms;
  }

  .grid-fade {
    position: absolute;
    inset: 0;
    z-index: 0;
    background-size: 20px 20px;
    background-position: 0 0;
    pointer-events: none;
    -webkit-mask-image: repeating-linear-gradient(
        to right,
        black 0px,
        black 3px,
        transparent 3px,
        transparent 8px
      ),
      repeating-linear-gradient(
        to bottom,
        black 0px,
        black 3px,
        transparent 3px,
        transparent 8px
      ),
      radial-gradient(ellipse 60% 60% at 50% 50%, #000 30%, transparent 70%);
    mask-image: repeating-linear-gradient(
        to right,
        black 0px,
        black 3px,
        transparent 3px,
        transparent 8px
      ),
      repeating-linear-gradient(
        to bottom,
        black 0px,
        black 3px,
        transparent 3px,
        transparent 8px
      ),
      radial-gradient(ellipse 60% 60% at 50% 50%, #000 30%, transparent 70%);
    -webkit-mask-composite: source-in;
    mask-composite: intersect;
  }

  .grid-fade--light {
    background-image:
      linear-gradient(to right, rgba(231, 229, 228, 0.65) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(231, 229, 228, 0.65) 1px, transparent 1px);
  }

  .grid-fade--dark {
    background-image:
      linear-gradient(to right, rgba(52, 56, 92, 0.55) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(52, 56, 92, 0.55) 1px, transparent 1px);
  }

  .cta-grid-light {
    background-image:
      linear-gradient(to right, #e7e5e4 1px, transparent 1px),
      linear-gradient(to bottom, #e7e5e4 1px, transparent 1px);
    background-size: 20px 20px;
    background-position: 0 0, 0 0;
    mask-image:
      repeating-linear-gradient(to right, black 0px, black 3px, transparent 3px, transparent 8px),
      repeating-linear-gradient(to bottom, black 0px, black 3px, transparent 3px, transparent 8px),
      radial-gradient(ellipse 60% 60% at 50% 50%, #000 30%, transparent 70%);
    -webkit-mask-image:
      repeating-linear-gradient(to right, black 0px, black 3px, transparent 3px, transparent 8px),
      repeating-linear-gradient(to bottom, black 0px, black 3px, transparent 3px, transparent 8px),
      radial-gradient(ellipse 60% 60% at 50% 50%, #000 30%, transparent 70%);
    mask-composite: intersect;
    -webkit-mask-composite: source-in;
  }

  .cta-grid-dark {
    background-image:
      linear-gradient(to right, rgba(52, 56, 92, 0.55) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(52, 56, 92, 0.55) 1px, transparent 1px);
    background-size: 20px 20px;
    background-position: 0 0, 0 0;
    mask-image:
      repeating-linear-gradient(to right, black 0px, black 3px, transparent 3px, transparent 8px),
      repeating-linear-gradient(to bottom, black 0px, black 3px, transparent 3px, transparent 8px),
      radial-gradient(ellipse 60% 60% at 50% 50%, #000 30%, transparent 70%);
    -webkit-mask-image:
      repeating-linear-gradient(to right, black 0px, black 3px, transparent 3px, transparent 8px),
      repeating-linear-gradient(to bottom, black 0px, black 3px, transparent 3px, transparent 8px),
      radial-gradient(ellipse 60% 60% at 50% 50%, #000 30%, transparent 70%);
    mask-composite: intersect;
    -webkit-mask-composite: source-in;
  }

  @keyframes marquee-horizontal {
    from {
      transform: translateX(0);
    }
    to {
      transform: translateX(calc(-100% - var(--marquee-gap)));
    }
  }

  @keyframes marquee-vertical {
    from {
      transform: translateY(0);
    }
    to {
      transform: translateY(calc(-100% - var(--marquee-gap)));
    }
  }

  .animate-marquee-horizontal {
    animation: marquee-horizontal var(--marquee-duration) infinite linear;
  }

  .animate-marquee-vertical {
    animation: marquee-vertical var(--marquee-duration) infinite linear;
  }
}
